geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints"]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.3, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints"]$val),
color = "darkorange1", size = 6,
hjust=1) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints"]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.4, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints"]$val),
color = "darkorange1", size = 6,
hjust=1) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints"]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.4, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints"]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints"]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.4, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints"]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 4,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.4, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.4, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.45, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.5, 0.8,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.45, 0.8,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 1.1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 1.1,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 1.2,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 1.2,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
ggtitle("xPoints") +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
packages.cran = c("tidyverse", "httr", "ggtext")
inst <- packages.cran %in% installed.packages()
if(length(packages.cran[!inst]) > 0) install.packages(packages.cran[!inst])
lapply(packages.cran, require, character.only=T)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#0072B2;'>Real Madrid 1 </span> ** - **
<span style='font-weight:bold; color:#0072B2;'> 2 Sheriff</span>
</span>",
x = "Sepal length (cm)", y = "Sepal width (cm)"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#0072B2;'>Real Madrid 1 </span> ** - **
<span style='font-weight:bold; color:#0072B2;'> 2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#0072B2;'>Real Madrid 1 </span>
<span style='font-weight:bold; color:#0072B2;'> 2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#0072B2;'>Real Madrid 1 </span> ** - **
<span style='font-weight:bold; color:#0072B2;'> 2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:##27408B;'>Real Madrid 1 </span> -
<span style='font-weight:bold; color:#FF7F00;'> 2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1 </span> -
<span style='font-weight:bold; color:#FF7F00;'> 2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1</span>
<span style='font-weight:bold; color:#FF7F00;'>2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1</span> -
<span style='font-weight:bold; color:#FF7F00;'>2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>.
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1</span> -
<span style='font-weight:bold; color:#FF7F00;'>2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1</span> -
<span style='font-weight:bold; color:#FF7F00;'>2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1.1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1</span> -
<span style='font-weight:bold; color:#FF7F00;'>2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 1)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1</span> -
<span style='font-weight:bold; color:#FF7F00;'>2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 0.)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
(gg.per.xpoints <- ggplot(simulacion.percentages %>% mutate(plot = "xPoints"), aes(x = plot, y = val, fill = stat)) +
geom_bar( stat = "identity", width = 0.6) +
geom_text(aes(label = paste0(ifelse(stat == "c.local.per", "1: ", ifelse(stat == "a.visitante.per", "2: ", "X: ")), scales::percent(val / 100))),
position = position_stack(vjust = 0.5)) +
annotate("text", x = 1.4, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "b.local.xpoints",]$val),
color = "royalblue4", size = 6) +
annotate("text", x = 1.35, 3.5,
label = paste0("xPoints: ", simulacion.xpoints[simulacion.xpoints$stat == "a.visitante.xpoints",]$val),
color = "darkorange1", size = 6) +
labs(
title = "<span style='font-size:18pt'>
<span style='font-weight:bold; color:#27408B;'>Real Madrid 1</span> -
<span style='font-weight:bold; color:#FF7F00;'>2 Sheriff</span>
</span>"
) +
coord_flip() +
theme_void() +
theme(legend.position = "none",
plot.title = element_markdown(lineheight = 0.55)) +
scale_fill_manual(values = c("c.local.per" = "royalblue4", "a.visitante.per" = "darkorange1", "b.empate.per" = "ivory4"))
)
